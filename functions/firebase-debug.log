[debug] [2025-01-04T02:48:09.910Z] ----------------------------------------------------------------------
[debug] [2025-01-04T02:48:09.911Z] Command:       /home/ben/.nvm/versions/node/v20.17.0/bin/node /home/ben/.nvm/versions/node/v20.17.0/bin/firebase deploy --only functions
[debug] [2025-01-04T02:48:09.912Z] CLI Version:   13.18.0
[debug] [2025-01-04T02:48:09.912Z] Platform:      linux
[debug] [2025-01-04T02:48:09.912Z] Node Version:  v20.17.0
[debug] [2025-01-04T02:48:09.912Z] Time:          Sat Jan 04 2025 02:48:09 GMT+0000 (Greenwich Mean Time)
[debug] [2025-01-04T02:48:09.912Z] ----------------------------------------------------------------------
[debug] 
[debug] [2025-01-04T02:48:09.954Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-01-04T02:48:09.954Z] > authorizing via signed-in user (brunyeeb@gmail.com)
[debug] [2025-01-04T02:48:09.954Z] [iam] checking project therapy-bot-6dad7 for permissions ["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]
[debug] [2025-01-04T02:48:09.955Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/therapy-bot-6dad7:testIamPermissions [none]
[debug] [2025-01-04T02:48:09.955Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/therapy-bot-6dad7:testIamPermissions x-goog-quota-user=projects/therapy-bot-6dad7
[debug] [2025-01-04T02:48:09.955Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/therapy-bot-6dad7:testIamPermissions {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]}
[debug] [2025-01-04T02:48:10.571Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/therapy-bot-6dad7:testIamPermissions 200
[debug] [2025-01-04T02:48:10.572Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/therapy-bot-6dad7:testIamPermissions {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]}
[debug] [2025-01-04T02:48:10.572Z] >>> [apiv2][query] POST https://iam.googleapis.com/v1/projects/therapy-bot-6dad7/serviceAccounts/therapy-bot-6dad7@appspot.gserviceaccount.com:testIamPermissions [none]
[debug] [2025-01-04T02:48:10.572Z] >>> [apiv2][body] POST https://iam.googleapis.com/v1/projects/therapy-bot-6dad7/serviceAccounts/therapy-bot-6dad7@appspot.gserviceaccount.com:testIamPermissions {"permissions":["iam.serviceAccounts.actAs"]}
[debug] [2025-01-04T02:48:11.146Z] <<< [apiv2][status] POST https://iam.googleapis.com/v1/projects/therapy-bot-6dad7/serviceAccounts/therapy-bot-6dad7@appspot.gserviceaccount.com:testIamPermissions 200
[debug] [2025-01-04T02:48:11.146Z] <<< [apiv2][body] POST https://iam.googleapis.com/v1/projects/therapy-bot-6dad7/serviceAccounts/therapy-bot-6dad7@appspot.gserviceaccount.com:testIamPermissions {"permissions":["iam.serviceAccounts.actAs"]}
[info] 
[info] === Deploying to 'therapy-bot-6dad7'...
[info] 
[info] i  deploying functions 
[info] Running command: npm --prefix "$RESOURCE_DIR" run build
[info] ✔  functions: Finished running predeploy script. 
[debug] [2025-01-04T02:48:13.677Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/therapy-bot-6dad7 [none]
[debug] [2025-01-04T02:48:13.871Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/therapy-bot-6dad7 200
[debug] [2025-01-04T02:48:13.871Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/therapy-bot-6dad7 {"projectId":"therapy-bot-6dad7","projectNumber":"1045420805272","displayName":"therapy-bot","name":"projects/therapy-bot-6dad7","resources":{"hostingSite":"therapy-bot-6dad7"},"state":"ACTIVE","etag":"1_76ac9ce2-a710-40ae-9191-62ab01989519"}
[info] i  functions: preparing codebase default for deployment 
[info] i  functions: ensuring required API cloudfunctions.googleapis.com is enabled... 
[info] i  functions: ensuring required API cloudbuild.googleapis.com is enabled... 
[info] i  artifactregistry: ensuring required API artifactregistry.googleapis.com is enabled... 
[debug] [2025-01-04T02:48:13.873Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/therapy-bot-6dad7/services/cloudfunctions.googleapis.com [none]
[debug] [2025-01-04T02:48:13.873Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/therapy-bot-6dad7/services/cloudfunctions.googleapis.com x-goog-quota-user=projects/therapy-bot-6dad7
[debug] [2025-01-04T02:48:13.874Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/therapy-bot-6dad7/services/runtimeconfig.googleapis.com [none]
[debug] [2025-01-04T02:48:13.874Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/therapy-bot-6dad7/services/runtimeconfig.googleapis.com x-goog-quota-user=projects/therapy-bot-6dad7
[debug] [2025-01-04T02:48:13.874Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/therapy-bot-6dad7/services/cloudbuild.googleapis.com [none]
[debug] [2025-01-04T02:48:13.874Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/therapy-bot-6dad7/services/cloudbuild.googleapis.com x-goog-quota-user=projects/therapy-bot-6dad7
[debug] [2025-01-04T02:48:13.875Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/therapy-bot-6dad7/services/artifactregistry.googleapis.com [none]
[debug] [2025-01-04T02:48:13.875Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/therapy-bot-6dad7/services/artifactregistry.googleapis.com x-goog-quota-user=projects/therapy-bot-6dad7
[debug] [2025-01-04T02:48:14.631Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/therapy-bot-6dad7/services/runtimeconfig.googleapis.com 200
[debug] [2025-01-04T02:48:14.631Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/therapy-bot-6dad7/services/runtimeconfig.googleapis.com [omitted]
[debug] [2025-01-04T02:48:14.633Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/therapy-bot-6dad7/services/cloudbuild.googleapis.com 200
[debug] [2025-01-04T02:48:14.633Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/therapy-bot-6dad7/services/cloudbuild.googleapis.com [omitted]
[info] ✔  functions: required API cloudbuild.googleapis.com is enabled 
[debug] [2025-01-04T02:48:14.637Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/therapy-bot-6dad7/services/artifactregistry.googleapis.com 200
[debug] [2025-01-04T02:48:14.637Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/therapy-bot-6dad7/services/artifactregistry.googleapis.com [omitted]
[info] ✔  artifactregistry: required API artifactregistry.googleapis.com is enabled 
[debug] [2025-01-04T02:48:14.639Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/therapy-bot-6dad7/services/cloudfunctions.googleapis.com 200
[debug] [2025-01-04T02:48:14.639Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/therapy-bot-6dad7/services/cloudfunctions.googleapis.com [omitted]
[info] ✔  functions: required API cloudfunctions.googleapis.com is enabled 
[debug] [2025-01-04T02:48:14.639Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/therapy-bot-6dad7/adminSdkConfig [none]
[debug] [2025-01-04T02:48:14.811Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/therapy-bot-6dad7/adminSdkConfig 200
[debug] [2025-01-04T02:48:14.811Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/therapy-bot-6dad7/adminSdkConfig {"projectId":"therapy-bot-6dad7","storageBucket":"therapy-bot-6dad7.firebasestorage.app"}
[debug] [2025-01-04T02:48:14.812Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/therapy-bot-6dad7/configs [none]
[debug] [2025-01-04T02:48:15.032Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/therapy-bot-6dad7/configs 200
[debug] [2025-01-04T02:48:15.032Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/therapy-bot-6dad7/configs {}
[debug] [2025-01-04T02:48:15.033Z] Validating nodejs source
[warn] ⚠  functions: package.json indicates an outdated version of firebase-functions. Please upgrade using npm install --save firebase-functions@latest in your functions directory. 
[warn] ⚠  functions: Please note that there will be breaking changes when you upgrade. 
[debug] [2025-01-04T02:48:15.328Z] > [functions] package.json contents: {
  "name": "functions",
  "scripts": {
    "build": "tsc",
    "build:watch": "tsc --watch",
    "serve": "npm run build && firebase emulators:start --only functions",
    "shell": "npm run build && firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "20"
  },
  "main": "lib/index.js",
  "dependencies": {
    "firebase-admin": "^12.1.0",
    "firebase-functions": "^5.0.0",
    "openai": "^4.77.0"
  },
  "devDependencies": {
    "firebase-functions-test": "^3.1.0",
    "typescript": "^4.9.0"
  },
  "private": true
}
[debug] [2025-01-04T02:48:15.328Z] Building nodejs source
[info] i  functions: Loading and analyzing source code for codebase default to determine what to deploy 
[debug] [2025-01-04T02:48:15.329Z] Could not find functions.yaml. Must use http discovery
[debug] [2025-01-04T02:48:15.332Z] Found firebase-functions binary at '/home/ben/projects/ai-therapy/functions/node_modules/.bin/firebase-functions'
[info] Serving at port 8481

[debug] [2025-01-04T02:48:15.496Z] Got response from /__/functions.yaml {"endpoints":{"chat":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":1,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","cpu":1,"labels":{},"callableTrigger":{},"entryPoint":"chat"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{},"params":[{"name":"OPENAI_API_KEY","type":"string"},{"name":"NODE_ENV","type":"string"}]}
[info] i  functions: Loaded environment variables from .env. 
[info] i  functions: preparing functions directory for uploading... 
[info] i  functions: packaged /home/ben/projects/ai-therapy/functions (205.65 KB) for uploading 
[debug] [2025-01-04T02:48:20.545Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v1/projects/therapy-bot-6dad7/locations/-/functions [none]
[debug] [2025-01-04T02:48:21.076Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v1/projects/therapy-bot-6dad7/locations/-/functions 200
[debug] [2025-01-04T02:48:21.076Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v1/projects/therapy-bot-6dad7/locations/-/functions {}
[debug] [2025-01-04T02:48:21.077Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/therapy-bot-6dad7/locations/-/functions filter=environment%3D%22GEN_2%22
[debug] [2025-01-04T02:48:21.987Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/therapy-bot-6dad7/locations/-/functions 200
[debug] [2025-01-04T02:48:21.987Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/therapy-bot-6dad7/locations/-/functions {"functions":[{"name":"projects/therapy-bot-6dad7/locations/us-central1/functions/chat","buildConfig":{"runtime":"nodejs20","entryPoint":"chat","source":{"storageSource":{"bucket":"gcf-v2-sources-1045420805272-us-central1","object":"chat/function-source.zip","generation":"1735958609530335"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"dockerRepository":"projects/therapy-bot-6dad7/locations/us-central1/repositories/gcf-artifacts","sourceProvenance":{},"dockerRegistry":"ARTIFACT_REGISTRY","serviceAccount":"projects/therapy-bot-6dad7/serviceAccounts/1045420805272-compute@developer.gserviceaccount.com","automaticUpdatePolicy":{}},"state":"UNKNOWN","updateTime":"2025-01-04T02:46:35.485096394Z","labels":{"deployment-tool":"cli-firebase","deployment-callable":"true","firebase-functions-hash":"79a15c21a9a28dde612a33e1bf9e2482b3c170f5"},"stateMessages":[{"severity":"ERROR","type":"CloudRunServiceNotFound","message":"Cloud Run service projects/therapy-bot-6dad7/locations/us-central1/services/chat for the function was not found. The function will not work correctly. Please redeploy."}],"environment":"GEN_2","url":"https://us-central1-therapy-bot-6dad7.cloudfunctions.net/chat","createTime":"2025-01-04T02:43:29.809783859Z"}]}
[info] i  functions: ensuring required API run.googleapis.com is enabled... 
[info] i  functions: ensuring required API eventarc.googleapis.com is enabled... 
[info] i  functions: ensuring required API pubsub.googleapis.com is enabled... 
[info] i  functions: ensuring required API storage.googleapis.com is enabled... 
[debug] [2025-01-04T02:48:21.989Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/therapy-bot-6dad7/services/run.googleapis.com [none]
[debug] [2025-01-04T02:48:21.989Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/therapy-bot-6dad7/services/run.googleapis.com x-goog-quota-user=projects/therapy-bot-6dad7
[debug] [2025-01-04T02:48:21.990Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/therapy-bot-6dad7/services/eventarc.googleapis.com [none]
[debug] [2025-01-04T02:48:21.990Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/therapy-bot-6dad7/services/eventarc.googleapis.com x-goog-quota-user=projects/therapy-bot-6dad7
[debug] [2025-01-04T02:48:21.991Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/therapy-bot-6dad7/services/pubsub.googleapis.com [none]
[debug] [2025-01-04T02:48:21.991Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/therapy-bot-6dad7/services/pubsub.googleapis.com x-goog-quota-user=projects/therapy-bot-6dad7
[debug] [2025-01-04T02:48:21.992Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/therapy-bot-6dad7/services/storage.googleapis.com [none]
[debug] [2025-01-04T02:48:21.992Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/therapy-bot-6dad7/services/storage.googleapis.com x-goog-quota-user=projects/therapy-bot-6dad7
[debug] [2025-01-04T02:48:22.703Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/therapy-bot-6dad7/services/eventarc.googleapis.com 200
[debug] [2025-01-04T02:48:22.703Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/therapy-bot-6dad7/services/eventarc.googleapis.com [omitted]
[info] ✔  functions: required API eventarc.googleapis.com is enabled 
[debug] [2025-01-04T02:48:22.705Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/therapy-bot-6dad7/services/run.googleapis.com 200
[debug] [2025-01-04T02:48:22.705Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/therapy-bot-6dad7/services/run.googleapis.com [omitted]
[info] ✔  functions: required API run.googleapis.com is enabled 
[debug] [2025-01-04T02:48:22.717Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/therapy-bot-6dad7/services/storage.googleapis.com 200
[debug] [2025-01-04T02:48:22.717Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/therapy-bot-6dad7/services/storage.googleapis.com [omitted]
[info] ✔  functions: required API storage.googleapis.com is enabled 
[debug] [2025-01-04T02:48:22.859Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/therapy-bot-6dad7/services/pubsub.googleapis.com 200
[debug] [2025-01-04T02:48:22.859Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/therapy-bot-6dad7/services/pubsub.googleapis.com [omitted]
[info] ✔  functions: required API pubsub.googleapis.com is enabled 
[info] i  functions: generating the service identity for pubsub.googleapis.com... 
[info] i  functions: generating the service identity for eventarc.googleapis.com... 
[debug] [2025-01-04T02:48:22.860Z] >>> [apiv2][query] POST https://serviceusage.googleapis.com/v1beta1/projects/1045420805272/services/pubsub.googleapis.com:generateServiceIdentity [none]
[debug] [2025-01-04T02:48:22.860Z] >>> [apiv2][query] POST https://serviceusage.googleapis.com/v1beta1/projects/1045420805272/services/eventarc.googleapis.com:generateServiceIdentity [none]
[debug] [2025-01-04T02:48:23.208Z] <<< [apiv2][status] POST https://serviceusage.googleapis.com/v1beta1/projects/1045420805272/services/pubsub.googleapis.com:generateServiceIdentity 200
[debug] [2025-01-04T02:48:23.208Z] <<< [apiv2][body] POST https://serviceusage.googleapis.com/v1beta1/projects/1045420805272/services/pubsub.googleapis.com:generateServiceIdentity {"name":"operations/finished.DONE_OPERATION","done":true,"response":{"@type":"type.googleapis.com/google.api.serviceusage.v1beta1.ServiceIdentity","email":"service-1045420805272@gcp-sa-pubsub.iam.gserviceaccount.com","uniqueId":"111899996285342541934"}}
[debug] [2025-01-04T02:48:23.586Z] <<< [apiv2][status] POST https://serviceusage.googleapis.com/v1beta1/projects/1045420805272/services/eventarc.googleapis.com:generateServiceIdentity 200
[debug] [2025-01-04T02:48:23.586Z] <<< [apiv2][body] POST https://serviceusage.googleapis.com/v1beta1/projects/1045420805272/services/eventarc.googleapis.com:generateServiceIdentity {"name":"operations/finished.DONE_OPERATION","done":true,"response":{"@type":"type.googleapis.com/google.api.serviceusage.v1beta1.ServiceIdentity","email":"service-1045420805272@gcp-sa-eventarc.iam.gserviceaccount.com","uniqueId":"117875806513462077794"}}
[warn] ⚠  functions: The following functions have reserved minimum instances. This will reduce the frequency of cold starts but increases the minimum cost. You will be charged for the memory allocation and a fraction of the CPU allocation of instances while they are idle.

	chat(us-central1): 1 instances, 256MB of memory each

With these options, your minimum bill will be $2.88 in a 30-day month 
[debug] [2025-01-04T02:49:13.726Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/therapy-bot-6dad7 [none]
[debug] [2025-01-04T02:49:13.933Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/therapy-bot-6dad7 200
[debug] [2025-01-04T02:49:13.933Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/therapy-bot-6dad7 {"projectId":"therapy-bot-6dad7","projectNumber":"1045420805272","displayName":"therapy-bot","name":"projects/therapy-bot-6dad7","resources":{"hostingSite":"therapy-bot-6dad7"},"state":"ACTIVE","etag":"1_76ac9ce2-a710-40ae-9191-62ab01989519"}
[debug] [2025-01-04T02:49:13.934Z] >>> [apiv2][query] POST https://cloudfunctions.googleapis.com/v2/projects/therapy-bot-6dad7/locations/us-central1/functions:generateUploadUrl [none]
[debug] [2025-01-04T02:49:14.704Z] <<< [apiv2][status] POST https://cloudfunctions.googleapis.com/v2/projects/therapy-bot-6dad7/locations/us-central1/functions:generateUploadUrl 200
[debug] [2025-01-04T02:49:14.704Z] <<< [apiv2][body] POST https://cloudfunctions.googleapis.com/v2/projects/therapy-bot-6dad7/locations/us-central1/functions:generateUploadUrl {"uploadUrl":"https://storage.googleapis.com/gcf-v2-uploads-1045420805272.us-central1.cloudfunctions.appspot.com/e2cebae9-2000-4982-8f5c-748bf0fa410c.zip?GoogleAccessId=service-1045420805272@gcf-admin-robot.iam.gserviceaccount.com&Expires=1735960757&Signature=UOEV%2B2uSShLrJiuCHdO%2FhLhjGGJGVZ5GcqdGDdHwIQ9xngYSYy7exEOONPnMb13CoDNaUUzExPhJ67cub%2BdaFJnqJUARoBUDz4Mv1quP8Zr8jwJMc7DVJDid93Nnu5ejsUgkXUvmhL2LMUDVp2t8GQBDXzZfWy9xJIXEZMpkv7duUF2a7brGe28vmE7pyWBYAer6EXLGK4ntouRjunGtl9k8meacbIPOU0fnOijbOaZp2rQIXbRKWvofhegx%2F%2FbMTfoMZjUcmf7OT4jN6KkXcxWsXk0%2Bw%2FAACynbczZepypNd9%2BnyuBVRFVroHrztSq%2B687E6bSW0tztv7zxY9RR%2FA%3D%3D","storageSource":{"bucket":"gcf-v2-uploads-1045420805272.us-central1.cloudfunctions.appspot.com","object":"e2cebae9-2000-4982-8f5c-748bf0fa410c.zip"}}
[debug] [2025-01-04T02:49:14.705Z] >>> [apiv2][query] PUT https://storage.googleapis.com/gcf-v2-uploads-1045420805272.us-central1.cloudfunctions.appspot.com/e2cebae9-2000-4982-8f5c-748bf0fa410c.zip GoogleAccessId=service-1045420805272%40gcf-admin-robot.iam.gserviceaccount.com&Expires=1735960757&Signature=UOEV%2B2uSShLrJiuCHdO%2FhLhjGGJGVZ5GcqdGDdHwIQ9xngYSYy7exEOONPnMb13CoDNaUUzExPhJ67cub%2BdaFJnqJUARoBUDz4Mv1quP8Zr8jwJMc7DVJDid93Nnu5ejsUgkXUvmhL2LMUDVp2t8GQBDXzZfWy9xJIXEZMpkv7duUF2a7brGe28vmE7pyWBYAer6EXLGK4ntouRjunGtl9k8meacbIPOU0fnOijbOaZp2rQIXbRKWvofhegx%2F%2FbMTfoMZjUcmf7OT4jN6KkXcxWsXk0%2Bw%2FAACynbczZepypNd9%2BnyuBVRFVroHrztSq%2B687E6bSW0tztv7zxY9RR%2FA%3D%3D
[debug] [2025-01-04T02:49:14.705Z] >>> [apiv2][body] PUT https://storage.googleapis.com/gcf-v2-uploads-1045420805272.us-central1.cloudfunctions.appspot.com/e2cebae9-2000-4982-8f5c-748bf0fa410c.zip [stream]
[debug] [2025-01-04T02:49:15.802Z] <<< [apiv2][status] PUT https://storage.googleapis.com/gcf-v2-uploads-1045420805272.us-central1.cloudfunctions.appspot.com/e2cebae9-2000-4982-8f5c-748bf0fa410c.zip 200
[debug] [2025-01-04T02:49:15.802Z] <<< [apiv2][body] PUT https://storage.googleapis.com/gcf-v2-uploads-1045420805272.us-central1.cloudfunctions.appspot.com/e2cebae9-2000-4982-8f5c-748bf0fa410c.zip [omitted]
[info] ✔  functions: functions folder uploaded successfully 
[info] i  functions: updating Node.js 20 (2nd Gen) function chat(us-central1)... 
[debug] [2025-01-04T02:49:15.805Z] >>> [apiv2][query] PATCH https://cloudfunctions.googleapis.com/v2/projects/therapy-bot-6dad7/locations/us-central1/functions/chat updateMask=name%2CbuildConfig.runtime%2CbuildConfig.entryPoint%2CbuildConfig.source.storageSource.bucket%2CbuildConfig.source.storageSource.object%2CbuildConfig.environmentVariables%2CbuildConfig.sourceToken%2CserviceConfig.environmentVariables%2CserviceConfig.ingressSettings%2CserviceConfig.timeoutSeconds%2CserviceConfig.serviceAccountEmail%2CserviceConfig.availableMemory%2CserviceConfig.minInstanceCount%2CserviceConfig.maxInstanceCount%2CserviceConfig.maxInstanceRequestConcurrency%2CserviceConfig.availableCpu%2CserviceConfig.vpcConnector%2CserviceConfig.vpcConnectorEgressSettings%2Clabels%2CbuildConfig.buildEnvironmentVariables
[debug] [2025-01-04T02:49:15.805Z] >>> [apiv2][body] PATCH https://cloudfunctions.googleapis.com/v2/projects/therapy-bot-6dad7/locations/us-central1/functions/chat {"name":"projects/therapy-bot-6dad7/locations/us-central1/functions/chat","buildConfig":{"runtime":"nodejs20","entryPoint":"chat","source":{"storageSource":{"bucket":"gcf-v2-uploads-1045420805272.us-central1.cloudfunctions.appspot.com","object":"e2cebae9-2000-4982-8f5c-748bf0fa410c.zip"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""}},"serviceConfig":{"environmentVariables":{"OPENAI_API_KEY":"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","NODE_ENV":"production","FIREBASE_CONFIG":"{\"projectId\":\"therapy-bot-6dad7\",\"storageBucket\":\"therapy-bot-6dad7.firebasestorage.app\"}","GCLOUD_PROJECT":"therapy-bot-6dad7","EVENTARC_CLOUD_EVENT_SOURCE":"projects/therapy-bot-6dad7/locations/us-central1/services/chat","FUNCTION_TARGET":"chat"},"ingressSettings":null,"timeoutSeconds":null,"serviceAccountEmail":null,"availableMemory":"256Mi","minInstanceCount":1,"maxInstanceCount":null,"maxInstanceRequestConcurrency":80,"availableCpu":"1","vpcConnector":null,"vpcConnectorEgressSettings":null},"labels":{"deployment-tool":"cli-firebase","deployment-callable":"true","firebase-functions-hash":"4860289af38ecf15c5d083ec2a814f34f0c1df26"}}
[debug] [2025-01-04T02:49:17.223Z] <<< [apiv2][status] PATCH https://cloudfunctions.googleapis.com/v2/projects/therapy-bot-6dad7/locations/us-central1/functions/chat 200
[debug] [2025-01-04T02:49:17.223Z] <<< [apiv2][body] PATCH https://cloudfunctions.googleapis.com/v2/projects/therapy-bot-6dad7/locations/us-central1/functions/chat {"name":"projects/therapy-bot-6dad7/locations/us-central1/operations/operation-1735958959754-62ad871240b45-defb1866-202161dd","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v2.OperationMetadata","createTime":"2025-01-04T02:49:20.468115323Z","target":"projects/therapy-bot-6dad7/locations/us-central1/functions/chat","verb":"update","cancelRequested":false,"apiVersion":"v2"},"done":false}
[debug] [2025-01-04T02:49:17.224Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/therapy-bot-6dad7/locations/us-central1/operations/operation-1735958959754-62ad871240b45-defb1866-202161dd [none]
[debug] [2025-01-04T02:49:17.892Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/therapy-bot-6dad7/locations/us-central1/operations/operation-1735958959754-62ad871240b45-defb1866-202161dd 200
[debug] [2025-01-04T02:49:17.892Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/therapy-bot-6dad7/locations/us-central1/operations/operation-1735958959754-62ad871240b45-defb1866-202161dd {"name":"projects/therapy-bot-6dad7/locations/us-central1/operations/operation-1735958959754-62ad871240b45-defb1866-202161dd","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v2.OperationMetadata","createTime":"2025-01-04T02:49:20.468115323Z","target":"projects/therapy-bot-6dad7/locations/us-central1/functions/chat","verb":"update","cancelRequested":false,"apiVersion":"v2","requestResource":{"@type":"type.googleapis.com/google.cloud.functions.v2.Function","name":"projects/therapy-bot-6dad7/locations/us-central1/functions/chat","buildConfig":{"runtime":"nodejs20","entryPoint":"chat","source":{"storageSource":{"bucket":"gcf-v2-sources-1045420805272-us-central1","object":"chat/function-source.zip","generation":"1735958960418131"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"dockerRepository":"projects/therapy-bot-6dad7/locations/us-central1/repositories/gcf-artifacts","sourceProvenance":{},"dockerRegistry":"ARTIFACT_REGISTRY","serviceAccount":"projects/therapy-bot-6dad7/serviceAccounts/1045420805272-compute@developer.gserviceaccount.com","automaticUpdatePolicy":{}},"serviceConfig":{"service":"projects/therapy-bot-6dad7/locations/us-central1/services/chat","timeoutSeconds":60,"environmentVariables":{"OPENAI_API_KEY":"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","NODE_ENV":"production","FIREBASE_CONFIG":"{\"projectId\":\"therapy-bot-6dad7\",\"storageBucket\":\"therapy-bot-6dad7.firebasestorage.app\"}","GCLOUD_PROJECT":"therapy-bot-6dad7","EVENTARC_CLOUD_EVENT_SOURCE":"projects/therapy-bot-6dad7/locations/us-central1/services/chat","FUNCTION_TARGET":"chat","LOG_EXECUTION_ID":"true"},"ingressSettings":"ALLOW_ALL","serviceAccountEmail":"1045420805272-compute@developer.gserviceaccount.com","minInstanceCount":1,"availableMemory":"256Mi","maxInstanceRequestConcurrency":80,"availableCpu":"1"},"state":"UNKNOWN","labels":{"deployment-callable":"true","firebase-functions-hash":"4860289af38ecf15c5d083ec2a814f34f0c1df26"},"stateMessages":[{"severity":"ERROR","type":"CloudRunServiceNotFound","message":"Cloud Run service projects/therapy-bot-6dad7/locations/us-central1/services/chat for the function was not found. The function will not work correctly. Please redeploy."}],"environment":"GEN_2","url":"https://us-central1-therapy-bot-6dad7.cloudfunctions.net/chat"},"stages":[{"name":"BUILD","state":"NOT_STARTED"},{"name":"SERVICE","state":"NOT_STARTED"}],"operationType":"UPDATE_FUNCTION"},"done":false}
[debug] [2025-01-04T02:49:18.393Z] [update-default-us-central1-chat] Retrying task index 0
[debug] [2025-01-04T02:49:18.393Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/therapy-bot-6dad7/locations/us-central1/operations/operation-1735958959754-62ad871240b45-defb1866-202161dd [none]
[debug] [2025-01-04T02:49:19.080Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/therapy-bot-6dad7/locations/us-central1/operations/operation-1735958959754-62ad871240b45-defb1866-202161dd 200
[debug] [2025-01-04T02:49:19.080Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/therapy-bot-6dad7/locations/us-central1/operations/operation-1735958959754-62ad871240b45-defb1866-202161dd {"name":"projects/therapy-bot-6dad7/locations/us-central1/operations/operation-1735958959754-62ad871240b45-defb1866-202161dd","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v2.OperationMetadata","createTime":"2025-01-04T02:49:20.468115323Z","target":"projects/therapy-bot-6dad7/locations/us-central1/functions/chat","verb":"update","cancelRequested":false,"apiVersion":"v2","requestResource":{"@type":"type.googleapis.com/google.cloud.functions.v2.Function","name":"projects/therapy-bot-6dad7/locations/us-central1/functions/chat","buildConfig":{"runtime":"nodejs20","entryPoint":"chat","source":{"storageSource":{"bucket":"gcf-v2-sources-1045420805272-us-central1","object":"chat/function-source.zip","generation":"1735958960418131"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"dockerRepository":"projects/therapy-bot-6dad7/locations/us-central1/repositories/gcf-artifacts","sourceProvenance":{},"dockerRegistry":"ARTIFACT_REGISTRY","serviceAccount":"projects/therapy-bot-6dad7/serviceAccounts/1045420805272-compute@developer.gserviceaccount.com","automaticUpdatePolicy":{}},"serviceConfig":{"service":"projects/therapy-bot-6dad7/locations/us-central1/services/chat","timeoutSeconds":60,"environmentVariables":{"OPENAI_API_KEY":"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","NODE_ENV":"production","FIREBASE_CONFIG":"{\"projectId\":\"therapy-bot-6dad7\",\"storageBucket\":\"therapy-bot-6dad7.firebasestorage.app\"}","GCLOUD_PROJECT":"therapy-bot-6dad7","EVENTARC_CLOUD_EVENT_SOURCE":"projects/therapy-bot-6dad7/locations/us-central1/services/chat","FUNCTION_TARGET":"chat","LOG_EXECUTION_ID":"true"},"ingressSettings":"ALLOW_ALL","serviceAccountEmail":"1045420805272-compute@developer.gserviceaccount.com","minInstanceCount":1,"availableMemory":"256Mi","maxInstanceRequestConcurrency":80,"availableCpu":"1"},"state":"UNKNOWN","labels":{"deployment-callable":"true","firebase-functions-hash":"4860289af38ecf15c5d083ec2a814f34f0c1df26"},"stateMessages":[{"severity":"ERROR","type":"CloudRunServiceNotFound","message":"Cloud Run service projects/therapy-bot-6dad7/locations/us-central1/services/chat for the function was not found. The function will not work correctly. Please redeploy."}],"environment":"GEN_2","url":"https://us-central1-therapy-bot-6dad7.cloudfunctions.net/chat"},"stages":[{"name":"BUILD","message":"Build in progress","state":"IN_PROGRESS","resource":"projects/1045420805272/locations/us-central1/builds/553fe0c8-46b9-48e0-9301-7c597f25a0fb","resourceUri":"https://console.cloud.google.com/cloud-build/builds;region=us-central1/553fe0c8-46b9-48e0-9301-7c597f25a0fb?project=1045420805272"},{"name":"SERVICE","state":"NOT_STARTED"}],"operationType":"UPDATE_FUNCTION","buildName":"projects/1045420805272/locations/us-central1/builds/553fe0c8-46b9-48e0-9301-7c597f25a0fb"},"done":false}
[debug] [2025-01-04T02:49:20.081Z] [update-default-us-central1-chat] Retrying task index 0
[debug] [2025-01-04T02:49:20.082Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/therapy-bot-6dad7/locations/us-central1/operations/operation-1735958959754-62ad871240b45-defb1866-202161dd [none]
[debug] [2025-01-04T02:49:20.760Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/therapy-bot-6dad7/locations/us-central1/operations/operation-1735958959754-62ad871240b45-defb1866-202161dd 200
[debug] [2025-01-04T02:49:20.760Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/therapy-bot-6dad7/locations/us-central1/operations/operation-1735958959754-62ad871240b45-defb1866-202161dd {"name":"projects/therapy-bot-6dad7/locations/us-central1/operations/operation-1735958959754-62ad871240b45-defb1866-202161dd","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v2.OperationMetadata","createTime":"2025-01-04T02:49:20.468115323Z","target":"projects/therapy-bot-6dad7/locations/us-central1/functions/chat","verb":"update","cancelRequested":false,"apiVersion":"v2","requestResource":{"@type":"type.googleapis.com/google.cloud.functions.v2.Function","name":"projects/therapy-bot-6dad7/locations/us-central1/functions/chat","buildConfig":{"runtime":"nodejs20","entryPoint":"chat","source":{"storageSource":{"bucket":"gcf-v2-sources-1045420805272-us-central1","object":"chat/function-source.zip","generation":"1735958960418131"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"dockerRepository":"projects/therapy-bot-6dad7/locations/us-central1/repositories/gcf-artifacts","sourceProvenance":{},"dockerRegistry":"ARTIFACT_REGISTRY","serviceAccount":"projects/therapy-bot-6dad7/serviceAccounts/1045420805272-compute@developer.gserviceaccount.com","automaticUpdatePolicy":{}},"serviceConfig":{"service":"projects/therapy-bot-6dad7/locations/us-central1/services/chat","timeoutSeconds":60,"environmentVariables":{"OPENAI_API_KEY":"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","NODE_ENV":"production","FIREBASE_CONFIG":"{\"projectId\":\"therapy-bot-6dad7\",\"storageBucket\":\"therapy-bot-6dad7.firebasestorage.app\"}","GCLOUD_PROJECT":"therapy-bot-6dad7","EVENTARC_CLOUD_EVENT_SOURCE":"projects/therapy-bot-6dad7/locations/us-central1/services/chat","FUNCTION_TARGET":"chat","LOG_EXECUTION_ID":"true"},"ingressSettings":"ALLOW_ALL","serviceAccountEmail":"1045420805272-compute@developer.gserviceaccount.com","minInstanceCount":1,"availableMemory":"256Mi","maxInstanceRequestConcurrency":80,"availableCpu":"1"},"state":"UNKNOWN","labels":{"deployment-callable":"true","firebase-functions-hash":"4860289af38ecf15c5d083ec2a814f34f0c1df26"},"stateMessages":[{"severity":"ERROR","type":"CloudRunServiceNotFound","message":"Cloud Run service projects/therapy-bot-6dad7/locations/us-central1/services/chat for the function was not found. The function will not work correctly. Please redeploy."}],"environment":"GEN_2","url":"https://us-central1-therapy-bot-6dad7.cloudfunctions.net/chat"},"stages":[{"name":"BUILD","message":"Build in progress","state":"IN_PROGRESS","resource":"projects/1045420805272/locations/us-central1/builds/553fe0c8-46b9-48e0-9301-7c597f25a0fb","resourceUri":"https://console.cloud.google.com/cloud-build/builds;region=us-central1/553fe0c8-46b9-48e0-9301-7c597f25a0fb?project=1045420805272"},{"name":"SERVICE","state":"NOT_STARTED"}],"operationType":"UPDATE_FUNCTION","buildName":"projects/1045420805272/locations/us-central1/builds/553fe0c8-46b9-48e0-9301-7c597f25a0fb"},"done":false}
[debug] [2025-01-04T02:49:22.762Z] [update-default-us-central1-chat] Retrying task index 0
[debug] [2025-01-04T02:49:22.762Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/therapy-bot-6dad7/locations/us-central1/operations/operation-1735958959754-62ad871240b45-defb1866-202161dd [none]
[debug] [2025-01-04T02:49:23.438Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/therapy-bot-6dad7/locations/us-central1/operations/operation-1735958959754-62ad871240b45-defb1866-202161dd 200
[debug] [2025-01-04T02:49:23.438Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/therapy-bot-6dad7/locations/us-central1/operations/operation-1735958959754-62ad871240b45-defb1866-202161dd {"name":"projects/therapy-bot-6dad7/locations/us-central1/operations/operation-1735958959754-62ad871240b45-defb1866-202161dd","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v2.OperationMetadata","createTime":"2025-01-04T02:49:20.468115323Z","target":"projects/therapy-bot-6dad7/locations/us-central1/functions/chat","verb":"update","cancelRequested":false,"apiVersion":"v2","requestResource":{"@type":"type.googleapis.com/google.cloud.functions.v2.Function","name":"projects/therapy-bot-6dad7/locations/us-central1/functions/chat","buildConfig":{"runtime":"nodejs20","entryPoint":"chat","source":{"storageSource":{"bucket":"gcf-v2-sources-1045420805272-us-central1","object":"chat/function-source.zip","generation":"1735958960418131"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"dockerRepository":"projects/therapy-bot-6dad7/locations/us-central1/repositories/gcf-artifacts","sourceProvenance":{},"dockerRegistry":"ARTIFACT_REGISTRY","serviceAccount":"projects/therapy-bot-6dad7/serviceAccounts/1045420805272-compute@developer.gserviceaccount.com","automaticUpdatePolicy":{}},"serviceConfig":{"service":"projects/therapy-bot-6dad7/locations/us-central1/services/chat","timeoutSeconds":60,"environmentVariables":{"OPENAI_API_KEY":"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","NODE_ENV":"production","FIREBASE_CONFIG":"{\"projectId\":\"therapy-bot-6dad7\",\"storageBucket\":\"therapy-bot-6dad7.firebasestorage.app\"}","GCLOUD_PROJECT":"therapy-bot-6dad7","EVENTARC_CLOUD_EVENT_SOURCE":"projects/therapy-bot-6dad7/locations/us-central1/services/chat","FUNCTION_TARGET":"chat","LOG_EXECUTION_ID":"true"},"ingressSettings":"ALLOW_ALL","serviceAccountEmail":"1045420805272-compute@developer.gserviceaccount.com","minInstanceCount":1,"availableMemory":"256Mi","maxInstanceRequestConcurrency":80,"availableCpu":"1"},"state":"UNKNOWN","labels":{"deployment-callable":"true","firebase-functions-hash":"4860289af38ecf15c5d083ec2a814f34f0c1df26"},"stateMessages":[{"severity":"ERROR","type":"CloudRunServiceNotFound","message":"Cloud Run service projects/therapy-bot-6dad7/locations/us-central1/services/chat for the function was not found. The function will not work correctly. Please redeploy."}],"environment":"GEN_2","url":"https://us-central1-therapy-bot-6dad7.cloudfunctions.net/chat"},"stages":[{"name":"BUILD","message":"Build in progress","state":"IN_PROGRESS","resource":"projects/1045420805272/locations/us-central1/builds/553fe0c8-46b9-48e0-9301-7c597f25a0fb","resourceUri":"https://console.cloud.google.com/cloud-build/builds;region=us-central1/553fe0c8-46b9-48e0-9301-7c597f25a0fb?project=1045420805272"},{"name":"SERVICE","state":"NOT_STARTED"}],"operationType":"UPDATE_FUNCTION","buildName":"projects/1045420805272/locations/us-central1/builds/553fe0c8-46b9-48e0-9301-7c597f25a0fb"},"done":false}
